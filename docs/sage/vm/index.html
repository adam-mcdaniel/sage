<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Virtual Machine Module"><title>sage::vm - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sage" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sage/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sage/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module vm</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">sage</a>::<wbr><a class="mod" href="#">vm</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sage/vm/mod.rs.html#1-166">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="virtual-machine-module"><a href="#virtual-machine-module">Virtual Machine Module</a></h2>
<p>This module contains all things related to the virtual machine.</p>
<h3 id="what-is-this-machine"><a href="#what-is-this-machine">What is this machine?</a></h3>
<p>This virtual machine is a simple turing tape machine.
There is one register, a tape of cells, and a tape pointer. Cells are
restricted to integers in the core variant of the machine code, but floats
are supported in the standard variant.</p>
<h3 id="what-should-i-know-first"><a href="#what-should-i-know-first">What should I know first?</a></h3>
<p>You should <em><strong>NOT</strong></em> use pointers (values used with the Deref, Refer, Where,
Alloc, and Free operations) as if they are integers. Think about pointers
and integers as two completely separate types.</p>
<h5 id="why"><a href="#why">Why?</a></h5>
<p>This is because virtual machine <strong>implementations are bound to vary</strong>.
For example: my C implementation uses <em>real pointers</em> (which are retrieved
through virtual machine instructions <code>Where</code> and <code>Alloc</code>, and allows the
implementation to be used with valgrind, gprof, a custom allocater, or
potentially garbage collection!), but an implementation in a language
like Python might use integer indices in a list instead.</p>
<p>If the backend implementation uses pointers, <em>using <code>Inc</code> to move a pointer
to the next cell <strong>will not work</strong></em>. This is because pointers need to be
incremented by the size of the data type they point to. Because the virtual
machine’s cell size is undefined (purposely, to make it as portable as possible),
<em><strong>you cannot know this size</strong></em>. Therefore you cannot use <code>Inc</code> to move a pointer
to the next cell unless <em>you want your code to be unportable</em>.</p>
<p><em><strong>DO NOT USE <code>Inc</code> AND <code>Dec</code> TO MOVE POINTERS! NAVIGATE THE POINTER TO THE
DESIRED POSITION AND USE <code>Where</code> INSTEAD! OR YOUR CODE WILL NOT PORT TO ALL
IMPLEMENTATIONS!!</strong></em></p>
<h3 id="what-data-can-it-use"><a href="#what-data-can-it-use">What data can it use?</a></h3>
<p><em><strong>The virtual machine uses cells of any arbitrary bit width &gt;= 16. The tape
must contain at least 4096 cells.</strong></em> The bit width is undefined, but <strong>it must
remain constant for every cells.</strong> Additionally, <strong>the floating point (and pointer)
representation must be identical in size to the integer representation</strong>.</p>
<p>In this particular assembler, we assume that the bit width is 64. Supporting
smaller or larger bit widths is supported just by using integers of the
appropriate size, or using addition / multiplication to reach larger numbers.</p>
<p><strong>An implementation of the virtual machine <em>should</em> be of any reasonable
bit width like: 16, 32, 64 bits (the standard), or unbounded.</strong> For each implementation, the bits
of the integer and floats supported should be identical. The
default implementation should be with 64 bit ints and floats, but
16 bit ints + no floats for a hardware implementation would suffice.
Infinitely large ints and floats are also supported, but the implementation
must be able to handle them.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CoreInterpreter.html" title="struct sage::vm::CoreInterpreter">CoreInterpreter</a></div><div class="desc docblock-short">The interpreter which runs the virtual machine program.</div></li><li><div class="item-name"><a class="struct" href="struct.CoreProgram.html" title="struct sage::vm::CoreProgram">CoreProgram</a></div><div class="desc docblock-short">A program of only core virtual machine instructions.</div></li><li><div class="item-name"><a class="struct" href="struct.StandardDevice.html" title="struct sage::vm::StandardDevice">StandardDevice</a></div><div class="desc docblock-short">A device used for standard input and output.
This simply retrieves a character from standard-in with <code>get</code>,
and writes a character to standard-out with <code>put</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.StandardInterpreter.html" title="struct sage::vm::StandardInterpreter">StandardInterpreter</a></div><div class="desc docblock-short">The interpreter which runs the standard variant of virtual machine programs.</div></li><li><div class="item-name"><a class="struct" href="struct.StandardProgram.html" title="struct sage::vm::StandardProgram">StandardProgram</a></div><div class="desc docblock-short">A program of core and standard virtual machine instructions.</div></li><li><div class="item-name"><a class="struct" href="struct.TestingDevice.html" title="struct sage::vm::TestingDevice">TestingDevice</a></div><div class="desc docblock-short">A device used for testing the compiler. This simply keeps a buffer
of sample input to supply to the virtual machine, and keeps an output
buffer to keep track of the output of the virtual machine.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.CoreOp.html" title="enum sage::vm::CoreOp">CoreOp</a></div><div class="desc docblock-short">An individual core virtual machine instruction.</div></li><li><div class="item-name"><a class="enum" href="enum.Error.html" title="enum sage::vm::Error">Error</a></div><div class="desc docblock-short">An error generated by the virtual machine.</div></li><li><div class="item-name"><a class="enum" href="enum.StandardOp.html" title="enum sage::vm::StandardOp">StandardOp</a></div><div class="desc docblock-short">An individual standard virtual machine instruction.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Device.html" title="trait sage::vm::Device">Device</a></div><div class="desc docblock-short">Create an input / output device for the virtual machine interpreter
to operate on. The method <code>get</code> retrieves the device’s input, and the
function <code>put</code> writes to the devices output.</div></li><li><div class="item-name"><a class="trait" href="trait.VirtualMachineProgram.html" title="trait sage::vm::VirtualMachineProgram">VirtualMachineProgram</a></div><div class="desc docblock-short">An interface to conveniently create virtual machine programs,
of either the core or standard variant.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.as_float.html" title="fn sage::vm::as_float">as_float</a></div><div class="desc docblock-short">A function to reinterpret the bits of an integer as a float.</div></li><li><div class="item-name"><a class="fn" href="fn.as_int.html" title="fn sage::vm::as_int">as_int</a></div><div class="desc docblock-short">A function to reinterpret the bits of a float as an integer.</div></li></ul></section></div></main></body></html>